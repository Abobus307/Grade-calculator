<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculator note</title>
  <style>
    :root {
      --accent: #4CAF50;
      --accent-hover: #45a049;
      --bg-base: #07080a;
      --grid: rgba(255,255,255,0.06);
      --wave1: rgba(120, 255, 180, 0.18);
      --wave2: rgba(130, 200, 255, 0.16);
      --card: #0e0f12;
      --card-border: rgba(255,255,255,0.10);
      --shadow: rgba(0,0,0,0.6);
      --text: #f2f4f7;
      --muted: rgba(242,244,247,0.72);
      --danger: #ff6b6b;
      --ring: rgba(76,175,80,0.22);
      --input-bg: rgba(255,255,255,0.07);
      --input-border: rgba(255,255,255,0.16);
      --glass: rgba(255,255,255,0.06);
      --glass-hover: rgba(255,255,255,0.10);
    }

    body.theme-light {
      --bg-base: #f6f7ff;
      --grid: rgba(0,0,0,0.06);
      --wave1: rgba(76,175,80,0.20);
      --wave2: rgba(90,170,255,0.18);
      --card: #ffffff;
      --card-border: rgba(0,0,0,0.08);
      --shadow: rgba(0,0,0,0.14);
      --text: #111;
      --muted: rgba(17,17,17,0.62);
      --danger: #c62828;
      --ring: rgba(76,175,80,0.18);
      --input-bg: #ffffff;
      --input-border: #ddd;
      --glass: rgba(0,0,0,0.04);
      --glass-hover: rgba(0,0,0,0.06);
    }

    html, body { height: 100%; margin: 0; }

    body {
      font-family: Arial, sans-serif;
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      background: var(--bg-base);
      transition: background-color 220ms ease, color 220ms ease;
    }

    .bg { position: fixed; inset: 0; z-index: -1; overflow: hidden; }

    .grid {
      position: absolute;
      inset: 0;
      background-image:
        linear-gradient(var(--grid) 1px, transparent 1px),
        linear-gradient(90deg, var(--grid) 1px, transparent 1px);
      background-size: 40px 40px;
      animation: gridMove 30s linear infinite;
    }

    @keyframes gridMove { from { background-position: 0 0; } to { background-position: 400px 400px; } }

    .wave {
      position: absolute;
      width: 160%;
      height: 160%;
      border-radius: 45%;
      filter: blur(60px);
      opacity: 0.8;
      animation: spin 26s linear infinite;
    }

    .wave.one { background: var(--wave1); top: -60%; left: -30%; animation-duration: 34s; }
    .wave.two { background: var(--wave2); bottom: -60%; right: -30%; animation-duration: 42s; }

    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

    .calculator {
      width: 320px;
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      padding: 20px;
      padding-top: 56px;
      box-shadow: 0 20px 44px var(--shadow);
      position: relative;
      backdrop-filter: blur(8px);
      animation: cardIn 420ms cubic-bezier(.2,.9,.2,1) forwards;
    }

    @keyframes cardIn {
      from { opacity: 0; transform: translateY(18px) scale(0.985); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    h1 { font-size: 18px; text-align: center; margin: 0 0 14px; }
    .hint { margin: 0 0 10px; font-size: 12px; color: var(--muted); line-height: 1.35; }

    .topControlsLeft { position: absolute; top: 10px; left: 10px; display: flex; gap: 8px; }
    .topControlsRight { position: absolute; top: 10px; right: 10px; }

    .iconBtn {
      height: 36px;
      padding: 0 12px;
      gap: 8px;
      border-radius: 10px;
      border: 1px solid var(--card-border);
      background: var(--glass);
      color: var(--text);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      user-select: none;
      transition: transform 140ms ease, background 180ms ease;
    }

    .iconBtn:hover { transform: translateY(-1px); background: var(--glass-hover); }
    .iconBtn:active { transform: translateY(1px) scale(0.98); }

    .flag {
      width: 20px;
      height: 14px;
      border-radius: 2px;
      background-size: cover;
      background-position: center;
      box-shadow: 0 0 0 1px rgba(0,0,0,0.25);
    }

    .flag.ro { background: linear-gradient(90deg, #002b7f 33%, #fcd116 33% 66%, #ce1126 66%); }
    .flag.ru { background: linear-gradient(#ffffff 33%, #0039a6 33% 66%, #d52b1e 66%); }

    /* NEW: scale selector */
    .scaleRow {
      display: flex;
      gap: 8px;
      margin: 0 0 10px;
    }

    .scaleBtn {
      flex: 1;
      height: 38px;
      border-radius: 10px;
      border: 1px solid var(--card-border);
      background: var(--glass);
      color: var(--text);
      cursor: pointer;
      transition: transform 140ms ease, background 180ms ease, border-color 180ms ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
    }

    .scaleBtn:hover { transform: translateY(-1px); background: var(--glass-hover); }
    .scaleBtn.active { border-color: var(--accent); box-shadow: 0 0 0 4px var(--ring); }
    .scaleBtn:active { transform: translateY(1px) scale(0.99); }

    input {
      width: 100%;
      box-sizing: border-box;
      padding: 10px;
      margin-bottom: 10px;
      font-size: 16px;
      color: var(--text);
      background: var(--input-bg);
      border: 1px solid var(--input-border);
      border-radius: 10px;
      outline: none;
    }

    input:focus { border-color: var(--accent); box-shadow: 0 0 0 4px var(--ring); }
    input.invalid { border-color: var(--danger); }

    button#calcBtn {
      width: 100%;
      padding: 11px 10px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background: var(--accent);
      color: #fff;
      transform: translateZ(0);
      box-shadow: 0 14px 26px rgba(0,0,0,0.22);
      transition: background 180ms ease, transform 120ms ease, box-shadow 180ms ease, filter 180ms ease;
      position: relative;
      overflow: hidden;
    }

    button#calcBtn:hover { background: var(--accent-hover); box-shadow: 0 18px 34px rgba(0,0,0,0.28); transform: translateY(-1px); }
    button#calcBtn:active { transform: translateY(1px) scale(0.99); filter: brightness(0.98); }

    @keyframes btnPop { 0% { transform: scale(1); } 40% { transform: scale(1.02); } 100% { transform: scale(1); } }
    @keyframes btnShake { 0%,100% { transform: translateX(0); } 20% { transform: translateX(-6px); } 40% { transform: translateX(6px); } 60% { transform: translateX(-4px); } 80% { transform: translateX(4px); } }
    @keyframes btnErrorFlash { 0% { filter: none; } 35% { filter: saturate(1.2) brightness(1.05); } 100% { filter: none; } }

    .btn-pop { animation: btnPop 220ms ease; }
    .btn-shake { animation: btnShake 320ms ease; }
    .btn-error { animation: btnErrorFlash 320ms ease; box-shadow: 0 18px 36px rgba(255, 107, 107, 0.18); }

    @keyframes ripple { to { transform: scale(3.2); opacity: 0; } }
    .ripple {
      position: absolute;
      border-radius: 50%;
      transform: scale(0);
      animation: ripple 520ms ease-out;
      background: rgba(255, 255, 255, 0.35);
      pointer-events: none;
    }

    @keyframes inputNudge { 0%,100% { transform: translateX(0); } 30% { transform: translateX(-4px); } 60% { transform: translateX(4px); } }
    input.invalid { border-color: var(--danger); animation: inputNudge 260ms ease; }

    .result {
      margin-top: 14px;
      text-align: center;
      font-size: 16px;
      min-height: 20px;
      opacity: 0;
      transition: opacity 220ms ease;
    }

    .result.show { opacity: 1; animation: resultPop 220ms ease; }

    @keyframes resultPop { 0% { transform: translateY(6px); opacity: 0; } 100% { transform: translateY(0); opacity: 1; } }
    .result.err { color: var(--danger); }

    @media (prefers-reduced-motion: reduce) {
      .grid, .wave, .calculator { animation: none !important; }
    }
  </style>
</head>
<body>
  <div class="bg">
    <div class="grid"></div>
    <div class="wave one"></div>
    <div class="wave two"></div>
  </div>

  <div class="calculator">
    <div class="topControlsLeft">
      <div class="iconBtn" id="langToggle"><span class="flag ro"></span><span class="langText">RO</span></div>
    </div>

    <div class="topControlsRight">
      <div class="iconBtn" id="themeToggle">☾</div>
    </div>

    <h1 id="title"></h1>
    <p class="hint" id="hint"></p>

    <!-- NEW: scale selector -->
    <div class="scaleRow" aria-label="Scale selector">
      <button class="scaleBtn" id="scale10" type="button">0–10</button>
      <button class="scaleBtn" id="scale5" type="button">0–5</button>
    </div>

    <input id="grades" />
    <button id="calcBtn"></button>
    <div class="result" id="result"></div>
  </div>

  <script>
    const texts = {
      ro: {
        title: (max) => `Calculator note (0–${max})`,
        hint: (max) => `Introduceți notele de la 0 la ${max}, separate prin virgulă. Exemplu: ${max}, ${max - 0.5}, ${max - 2}`,
        placeholder: (max) => `Note (0–${max}) separate prin virgulă`,
        button: 'Calculează media',
        error: (max) => `Introduceți note corecte de la 0 la ${max}`,
        result: v => 'Media: ' + v
      },
      ru: {
        title: (max) => `Калькулятор оценок (0–${max})`,
        hint: (max) => `Введите оценки от 0 до ${max} через запятую. Пример: ${max}, ${max - 0.5}, ${max - 2}`,
        placeholder: (max) => `Оценки (0–${max}) через запятую`,
        button: 'Посчитать средний балл',
        error: (max) => `Введите корректные оценки от 0 до ${max}`,
        result: v => 'Средний балл: ' + v
      }
    };

    let lang = localStorage.getItem('lang') || 'ro';
    let scaleMax = Number(localStorage.getItem('scaleMax')) || 10; // NEW
    let lastCalc = null;

    const title = document.getElementById('title');
    const hint = document.getElementById('hint');
    const grades = document.getElementById('grades');
    const calcBtn = document.getElementById('calcBtn');
    const result = document.getElementById('result');
    const langToggle = document.getElementById('langToggle');
    const themeToggle = document.getElementById('themeToggle');

    // NEW
    const scale10 = document.getElementById('scale10');
    const scale5 = document.getElementById('scale5');

    function setScale(max) {
      scaleMax = max;
      localStorage.setItem('scaleMax', String(scaleMax));
      scale10.classList.toggle('active', scaleMax === 10);
      scale5.classList.toggle('active', scaleMax === 5);
      applyLang(); // обновит тексты/плейсхолдер
      // если уже был результат — пересчёт не делаем автоматически, но оставим текст
      // (можешь легко включить auto-recalc, если хочешь)
    }

    function applyLang() {
      const t = texts[lang];
      document.documentElement.lang = lang;
      document.title = t.title(scaleMax);
      title.textContent = t.title(scaleMax);
      hint.textContent = t.hint(scaleMax);
      grades.placeholder = t.placeholder(scaleMax);
      calcBtn.textContent = t.button;
      langToggle.querySelector('.flag').className = 'flag ' + lang;
      langToggle.querySelector('.langText').textContent = lang.toUpperCase();

      if (lastCalc && result.classList.contains('show')) {
        if (lastCalc.kind === 'error') {
          result.textContent = texts[lang].error(scaleMax);
          result.classList.add('err');
        } else {
          result.textContent = texts[lang].result(lastCalc.value);
          result.classList.remove('err');
        }
      }
    }

    function parseGradesValue(v) {
      return v
        .split(',')
        .map(x => parseFloat(x.trim()))
        .filter(x => !Number.isNaN(x) && x >= 0 && x <= scaleMax); // NEW: зависит от шкалы
    }

    function addRipple(btn, x, y) {
      const r = document.createElement('span');
      r.className = 'ripple';
      const rect = btn.getBoundingClientRect();
      const size = Math.max(rect.width, rect.height);
      r.style.width = r.style.height = size + 'px';
      r.style.left = (x - rect.left - size / 2) + 'px';
      r.style.top = (y - rect.top - size / 2) + 'px';
      btn.appendChild(r);
      r.addEventListener('animationend', () => r.remove(), { once: true });
    }

    function kick(el, cls) {
      el.classList.remove(cls);
      void el.offsetWidth;
      el.classList.add(cls);
    }

    function calculate() {
      grades.classList.remove('invalid');
      result.classList.remove('show', 'err');
      kick(calcBtn, 'btn-pop');

      const nums = parseGradesValue(grades.value);
      if (!nums.length) {
        grades.classList.add('invalid');
        kick(calcBtn, 'btn-shake');
        kick(calcBtn, 'btn-error');
        result.textContent = texts[lang].error(scaleMax); // NEW
        result.classList.add('err', 'show');
        lastCalc = { kind: 'error' };
        return;
      }

      const avg = (nums.reduce((a, b) => a + b, 0) / nums.length).toFixed(2);
      result.textContent = texts[lang].result(avg);
      lastCalc = { kind: 'avg', value: avg };
      result.classList.add('show');
    }

    calcBtn.addEventListener('click', (e) => {
      addRipple(calcBtn, e.clientX, e.clientY);
      calculate();
    });
    grades.addEventListener('keydown', (e) => { if (e.key === 'Enter') calculate(); });

    langToggle.addEventListener('click', () => {
      lang = lang === 'ro' ? 'ru' : 'ro';
      localStorage.setItem('lang', lang);
      applyLang();
    });

    themeToggle.addEventListener('click', () => {
      const isLight = document.body.classList.toggle('theme-light');
      themeToggle.textContent = isLight ? '☀' : '☾';
      localStorage.setItem('theme', isLight ? 'light' : 'dark');
    });

    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') {
      document.body.classList.add('theme-light');
      themeToggle.textContent = '☀';
    }

    scale10.addEventListener('click', () => setScale(10));
    scale5.addEventListener('click', () => setScale(5));
    setScale(scaleMax);

    applyLang();
  </script>
</body>
</html>
